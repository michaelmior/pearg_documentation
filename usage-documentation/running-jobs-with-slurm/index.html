<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="generator" content="Hugo 0.26" />
    <meta name="description" content="Documentation on how to run SLURM jobs.">


    <title>Running Jobs with SLURM :: PEARG Documentation</title>
    <link rel="shortcut icon" href="/pearg_documentation/images/favicon.png" type="image/x-icon" />
    <link href="/pearg_documentation/css/nucleus.css" rel="stylesheet">
    <link href="/pearg_documentation/css/font-awesome.min.css" rel="stylesheet">
    <link href="/pearg_documentation/css/hybrid.css" rel="stylesheet">
    <link href="/pearg_documentation/css/featherlight.min.css" rel="stylesheet">
    <link href="/pearg_documentation/css/horsey.css" rel="stylesheet">
    
    <link href="/pearg_documentation/css/theme.css" rel="stylesheet">
    
    
      <link href="/pearg_documentation/css/theme-blue.css" rel="stylesheet">
    
    <link rel="stylesheet" href="/pearg_documentation/css/bootstrap.min.css">
    <script src="/pearg_documentation/js/jquery-2.x.min.js"></script>
    <style type="text/css">
      :root #header + #content > #left > #rlblock_left {
        display:none !important;
      }
    </style>

    

    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-79101-13', 'auto');
  ga('send', 'pageview');

</script>
  </head>
  <body class="" data-url="/pearg_documentation/usage-documentation/running-jobs-with-slurm/">
    <nav id="sidebar" class="">





<div class="highlightable">
  <div id="header-wrapper">
    <div id="header">
       
	<p>PEARG Documentation</p>
 


    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fa fa-search"></i></label>
    <input data-search-input id="search-by" type="text" placeholder="Search...">
    <span data-search-clear=""><i class="fa fa-close"></i></span>
</div>
<script type="text/javascript" src="/pearg_documentation/js/lunr.min.js"></script>
<script type="text/javascript" src="/pearg_documentation/js/horsey.js"></script>
<script type="text/javascript">
    var baseurl = "https:\/\/pearg.github.io\/pearg_documentation\/";
</script>
<script type="text/javascript" src="/pearg_documentation/js/search.js"></script>

    
  </div>

  
    <ul class="topics">
        
            <li data-nav-id="/pearg_documentation/" class="dd-item">
            <a href="/pearg_documentation/"><i class="fa fa-fw fa-home"></i></a>
            </li>
        
        
        
          
          


 
  
    
    <li data-nav-id="/pearg_documentation/getting-started/" class="dd-item 
        
        
        parent
        ">
      <a href="/pearg_documentation/getting-started/">
        <span>Getting Started</span>

        
        

          
            <i class="fa fa-angle-down fa-lg category-icon"></i>
          

        

        
      </a>
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/pearg_documentation/getting-started/hpc-resources/" class="dd-item
     
      ">
        <a href="/pearg_documentation/getting-started/hpc-resources/">
        <span>Compute Resources</span> 
        
        </a></li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pearg_documentation/getting-started/getting-an-account/" class="dd-item
     
      ">
        <a href="/pearg_documentation/getting-started/getting-an-account/">
        <span>Getting an Account</span> 
        
        </a></li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pearg_documentation/getting-started/getting-help/" class="dd-item
     
      ">
        <a href="/pearg_documentation/getting-started/getting-help/">
        <span>Getting Help</span> 
        
        </a></li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/pearg_documentation/best-practices/" class="dd-item 
        
        
        parent
        ">
      <a href="/pearg_documentation/best-practices/">
        <span>Best Practices</span>

        
        

          
            <i class="fa fa-angle-down fa-lg category-icon"></i>
          

        

        
      </a>
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/pearg_documentation/best-practices/directory-structure/" class="dd-item
     
      ">
        <a href="/pearg_documentation/best-practices/directory-structure/">
        <span>Directory Structure</span> 
        
        </a></li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pearg_documentation/best-practices/naming-files/" class="dd-item
     
      ">
        <a href="/pearg_documentation/best-practices/naming-files/">
        <span>Naming Files</span> 
        
        </a></li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pearg_documentation/best-practices/backing-up-your-data/" class="dd-item
     
      ">
        <a href="/pearg_documentation/best-practices/backing-up-your-data/">
        <span>Backing Up Your Data</span> 
        
        </a></li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/pearg_documentation/metadata-documentation/" class="dd-item 
        
        
        parent
        ">
      <a href="/pearg_documentation/metadata-documentation/">
        <span>Metadata Documentation</span>

        
        

          
            <i class="fa fa-angle-down fa-lg category-icon"></i>
          

        

        
      </a>
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/pearg_documentation/metadata-documentation/metadata-overview/" class="dd-item
     
      ">
        <a href="/pearg_documentation/metadata-documentation/metadata-overview/">
        <span>Metadata Overview</span> 
        
        </a></li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pearg_documentation/metadata-documentation/using-mediaflux/" class="dd-item
     
      ">
        <a href="/pearg_documentation/metadata-documentation/using-mediaflux/">
        <span>Using Mediaflux</span> 
        
        </a></li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pearg_documentation/metadata-documentation/mediaflux-explorer/" class="dd-item
     
      ">
        <a href="/pearg_documentation/metadata-documentation/mediaflux-explorer/">
        <span>Mediaflux Explorer</span> 
        
        </a></li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pearg_documentation/metadata-documentation/sample-map/" class="dd-item
     
      ">
        <a href="/pearg_documentation/metadata-documentation/sample-map/">
        <span>Sample Map</span> 
        
        </a></li>
     
  
 

            
          
             
            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/pearg_documentation/usage-documentation/" class="dd-item 
        parent
        
        parent
        ">
      <a href="/pearg_documentation/usage-documentation/">
        <span>Usage Documentation</span>

        
        

          
            <i class="fa fa-angle-down fa-lg category-icon"></i>
          

        

        
      </a>
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/pearg_documentation/usage-documentation/running-jobs-with-slurm/" class="dd-item
     active
      ">
        <a href="/pearg_documentation/usage-documentation/running-jobs-with-slurm/">
        <span>Running Jobs with SLURM</span> 
        
        </a></li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pearg_documentation/usage-documentation/installing-software/" class="dd-item
     
      ">
        <a href="/pearg_documentation/usage-documentation/installing-software/">
        <span>Installing Software</span> 
        
        </a></li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pearg_documentation/usage-documentation/stacks-databases/" class="dd-item
     
      ">
        <a href="/pearg_documentation/usage-documentation/stacks-databases/">
        <span>Stacks Databases</span> 
        
        </a></li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/pearg_documentation/usage-documentation/rad-seq-pipeline/" class="dd-item
     
      ">
        <a href="/pearg_documentation/usage-documentation/rad-seq-pipeline/">
        <span>Using the RAD-seq Pipeline</span> 
        
        </a></li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/pearg_documentation/tutorials/" class="dd-item 
        
        
        parent
        ">
      <a href="/pearg_documentation/tutorials/">
        <span>Tutorials</span>

        
        

          
            <i class="fa fa-angle-down fa-lg category-icon"></i>
          

        

        
      </a>
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/pearg_documentation/tutorials/intro-rad-seq/" class="dd-item
     
      ">
        <a href="/pearg_documentation/tutorials/intro-rad-seq/">
        <span>Introduction to RAD-Seq</span> 
        
        </a></li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
        

        
        <section id="shortcuts">
            
                <li class="" role="">
                    <h3>More</h3>
                    <a href="https://github.com/pearg/pearg_documentation"><i class='fa fa-github'></i> Github repo</a>
                    
                </li>
            
                <li class="" role="">
                    
                    <a href="https://gohugo.io/"><i class='fa fa-book'></i> Hugo Documentation</a>
                    
                </li>
            
                <li class="" role="">
                    
                    <a href="https://github.com/vjeantet/hugo-theme-docdock"><i class='fa fa-bookmark'></i> DocDock Theme</a>
                    
                </li>
            
                <li class="" role="">
                    
                    <a href="https://blogs.unimelb.edu.au/pearg/"><i class='fa fa-globe'></i> PEARG homepage</a>
                    
                </li>
            
        </section>    
        
        

        
    </ul>
    
     
    <section id="footer">
      
    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
        
          <div id="top-bar">
            
              
              
              
            <div id="top-github-link">
              <a class="github-link" href="https://github.com/pearg/pearg_documentation/edit/master/content/usage-documentation/running-jobs-with-slurm.md" target="blank">
                <i class="fa fa-code-fork"></i>
                Edit page
              </a>
            </div>
              
            

            <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                <span id="sidebar-toggle-span">
                  <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                    <i class="fa fa-bars"></i>
                  </a>
                </span>
                <span id="toc-menu"><i class="fa fa-list-alt"></i></span>
                <span class="links">
                







 <a href='/pearg_documentation/'>PEARG Documentation</a> > <a href='/pearg_documentation/usage-documentation/'>Usage Documentation</a> > Running Jobs with SLURM

 

 

   
                </span>
            </div>
            <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#checking-the-status-of-your-jobs">Checking the status of your jobs</a>
<ul>
<li><a href="#squeue">squeue</a>
<ul>
<li><a href="#scontrol-show-job">scontrol show job</a></li>
<li><a href="#sacct">sacct</a></li>
<li><a href="#sinfo">sinfo</a></li>
</ul></li>
</ul></li>
<li><a href="#running-your-jobs">Running your jobs</a>
<ul>
<li><a href="#sbatch">sbatch</a></li>
<li><a href="#sinteractive">sinteractive</a></li>
<li><a href="#scancel">scancel</a></li>
</ul></li>
<li><a href="#writing-a-slurm-script">Writing a SLURM script</a></li>
</ul></li>
</ul>
</nav>
    </div>
</div>

          </div>
        
        
        <div id="body-inner">
          
            <h1>Running Jobs with SLURM</h1>
          






<p>Using a computer cluster with other users means sharing resources. SLURM
(Simple Linux Utility for Resource Management) is a commonly used job scheduler
that manages a queue where you submit your jobs and allocates
resources to run your job when resources are available.</p>

<p>The documentation on using SLURM at Melbourne Bioinformatics is quite
comprehensive and can be found
<a href="https://www.melbournebioinformatics.org.au/documentation/running_jobs/slurm_x86/">here</a>.</p>

<h2 id="checking-the-status-of-your-jobs">Checking the status of your jobs</h2>

<h3 id="squeue">squeue</h3>

<p>You can view information about jobs in the SLURM queue with the <code>squeue</code>
command. View the help message with <code>squeue --usage</code> or the manual with
<code>man squeue</code>.</p>

<pre><code class="language-bash"># List all jobs in the queue
squeue

# List all jobs for account UOM0041
squeue --account=UOM0041

# List all jobs in the queue for user jchung in long format
squeue -l -u jchung
</code></pre>

<p>If you&rsquo;re using snowy or barcoo, you can also use the <code>showq</code> command.</p>

<h4 id="scontrol-show-job">scontrol show job</h4>

<p>If you want information regarding a specific job id, you can use <code>scontrol</code>.</p>

<pre><code class="language-bash">scontrol show job &lt;job-id&gt;
</code></pre>

<h4 id="sacct">sacct</h4>

<p>You can check the status of recently finished jobs with <code>sacct</code>.</p>

<pre><code class="language-bash">sacct
</code></pre>

<h4 id="sinfo">sinfo</h4>

<p>You can also view the status of the nodes in the cluster with <code>sinfo</code>.</p>

<pre><code class="language-bash"># Show status of all nodes
sinfo -Nel
</code></pre>

<p>If you want more information about a specific node, you can use <code>scontrol</code>.</p>

<pre><code class="language-bash"># View information on the master node
scontrol show node master
</code></pre>

<h2 id="running-your-jobs">Running your jobs</h2>

<h3 id="sbatch">sbatch</h3>

<p>Most of your jobs will be sumbitted to SLURM via <code>sbatch</code>. The commands that
you want to run need to be written in a script (a plain-text file that we&rsquo;ll
discuss further below), saved to a location, then submitted using <code>sbatch</code>.</p>

<pre><code class="language-bash"># Print the help message from sbatch
sbatch --help

# Submit your script by specifying the name of your script
sbatch my-script.sh
</code></pre>

<h3 id="sinteractive">sinteractive</h3>

<p>You can use the <code>sinteractive</code> command to run your job in an interactive
session. When SLURM allocates your job resources, you will be provided with
an interactive terminal session. It is recommended to use sinteractive in
conjunction with a terminal multiplexer such as GUN Screen so the job won&rsquo;t
terminate if you disconnect from the server.</p>

<pre><code class="language-bash"># Print the help message for sinteractive
sinteractive --help

# Submit a job with the default parameters
sinteractive

# Submit a job with 4 CPUs, 16 GB memory, and wall time of 1 day
sinteractive --ntasks=1 --cpu-per-task=4 --mem=16384 --time=1-0:0:0
</code></pre>

<p>Note that the memory amount is specified in MB.</p>

<h3 id="scancel">scancel</h3>

<p>You can cancel a running job or a job in the queue with <code>scancel</code>.</p>

<pre><code class="language-bash">scancel &lt;job-id&gt;
</code></pre>

<h2 id="writing-a-slurm-script">Writing a SLURM script</h2>

<p>For beginners, I recommend using the
<a href="https://www.melbournebioinformatics.org.au/jobscript-generator/">job script generator</a>
written by Melbourne Bioinformatics.
If you&rsquo;re using one of the PEARG clusters on the Nectar cloud (i.e. mozzie or
rescue), you can ignore the &ldquo;Project ID&rdquo; and the &ldquo;Modules&rdquo; field.</p>

<p>Here&rsquo;s an example of a simple SLURM script running on the mozzie server.</p>

<pre><code class="language-bash">#!/bin/bash
#SBATCH --job-name=denovo_map
#SBATCH --nodes=1
#SBATCH --ntasks=1
#SBATCH --cpus-per-task=8

denovo_map.pl \
    -m 3 -M 2 -n 1 -T 8 -b 1 -S \
    -o denovo_map_m3_M2_n1_2017-11-09 \
    -s ../processed_radtags/sample-1.fastq.gz \
    -s ../processed_radtags/sample-2.fastq.gz \
    -X &quot;populations: --vcf&quot;
</code></pre>

<p>The first line of the script must specify the interpreter the script will be
executed with such as <code>bash</code> or <code>sh</code>. Keep this as <code>#!/bin/bash</code> unless you
have reason to change it.</p>

<p>Each line starting with <code>#SBATCH</code> is an option that SLURM&rsquo;s <code>sbatch</code> command
uses. You can get view all available options with <code>sbatch -h</code> or by viewing
the man page with <code>man sbatch</code>.</p>

<p>The most common <code>#SBATCH</code> options you&rsquo;ll most likely be using are:</p>

<ul>
<li><code>--job-name=XXX</code>: You should always specify a job name for your job</li>
<li><code>--nodes=1</code>: In most cases, you should be requesting one node so all the
requested CPUs are on the same node.</li>
<li><code>--ntasks=1</code>: In most cases you&rsquo;ll be running one task per job</li>
<li><code>--cpus-per-task=X</code>: Specify the number of CPUs to request.</li>
</ul>

<p>You can also direct your stdout and stderr into defined files:</p>

<ul>
<li><code>-output my-file-%j.out</code></li>
<li><code>-error my-file-%j.err</code></li>
</ul>

<p>If you&rsquo;re using barcoo or snowy, you&rsquo;ll also need to specify memory in MB with:</p>

<ul>
<li><code>--mem=XXXXX</code> for jobs using multiple CPUs, or</li>
<li><code>--mem-per-cpu=XXXX</code> for single CPU jobs.</li>
</ul>

<p>With barcoo and snowy, you&rsquo;ll also need to specify the partition, and a time limit:</p>

<ul>
<li><code>-p main</code>: The partition is called &lsquo;main&rsquo;</li>
<li><code>--time=D-HH:MM:SS</code>: Time limit given for the job. If the job exceeds the time,
it is automatically terminated.</li>
</ul>

<p>Here&rsquo;s an example of a SLURM script for barcoo.</p>

<pre><code class="language-bash">#!/bin/bash

# Partition for the job:
#SBATCH -p main

# Account to run the job:
#SBATCH --account=VR0002

# Multithreaded (SMP) job: must run on one node
#SBATCH --nodes=1

# The name of the job:
#SBATCH --job-name=&quot;test-job&quot;

# Maximum number of tasks/CPU cores used by the job:
#SBATCH --ntasks=1
#SBATCH --cpus-per-task=8

# The amount of memory in megabytes per process in the job:
#SBATCH --mem=32768

# The maximum running time of the job in days-hours:mins:sec
#SBATCH --time=0-1:0:00

# Run the job from your home directory:
cd $HOME

# The job command(s):
sleep 10
</code></pre>

<p>When using barcoo and snowy, don&rsquo;t forget to <code>module load</code> the software you
need into your environment path.</p>


<footer class=" footline" >
	
</footer>



      </div>
    </div>

    
 
    

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
        
        


        
            <a class="nav nav-prev" href="/pearg_documentation/usage-documentation/" title="Usage Documentation"> <i class="fa fa-chevron-left"></i></a>
        
        
            <a class="nav nav-next" href="/pearg_documentation/usage-documentation/installing-software/" title="Installing Software" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
        
    </div>

    </section>
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/pearg_documentation/js/clipboard.min.js"></script>
    <script src="/pearg_documentation/js/featherlight.min.js"></script>
    <script src="/pearg_documentation/js/html5shiv-printshiv.min.js"></script>
    <script src="/pearg_documentation/js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/pearg_documentation/js/modernizr.custom.71422.js"></script>
    <script src="/pearg_documentation/js/learn.js"></script>
    <script src="/pearg_documentation/js/hugo-learn.js"></script>

    
    <link href="/pearg_documentation/mermaid/mermaid.css" type="text/css" rel="stylesheet"/>
    <script src="/pearg_documentation/mermaid/mermaid.js"></script>
    <script>mermaid.initialize({startOnLoad:true});</script>
    

    

  </body>
</html>

