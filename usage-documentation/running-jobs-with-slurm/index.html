<!DOCTYPE html>
<html>
  <head>
    <title>PEARG Documentation</title>
    
      <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="revised" content="2022-01-25T16:19:04 AEDT">
<title>Running Jobs with SLURM :: PEARG Documentation</title>
<link rel="shortcut icon" href="/pearg_documentation/images/favicon.png" type="image/x-icon" />
<link href="/pearg_documentation/css/nucleus.css" rel="stylesheet">
<link href="/pearg_documentation/css/font-awesome.min.css" rel="stylesheet">
<link href="/pearg_documentation/css/featherlight.min.css" rel="stylesheet">
<link href="/pearg_documentation/css/auto-complete.css" rel="stylesheet">
<link href="/pearg_documentation/theme-flex/style.css" rel="stylesheet">

	<link href="/pearg_documentation/theme-flex/variant-blue.css" rel="stylesheet">

<link rel="stylesheet" href="/pearg_documentation/css/bootstrap.min.css">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-79101-13', 'auto');
  ga('send', 'pageview');

</script>

    
  </head>
  <body data-url="/pearg_documentation/usage-documentation/running-jobs-with-slurm/">
    
      <header>
  <div class="logo">
    
	
  
    <p>PEARG Documentation</p>

  


  </div>
  <div class="burger"><a href="javascript:void(0);" style="font-size:15px;">&#9776;</a></div>
    <nav class="shortcuts">
            <li class="" role="">
                <a href="https://github.com/pearg/pearg_documentation"  rel="noopener">
                  <i class='fa fa-github'></i> Github repo
                </a>
            </li>
            <li class="" role="">
                <a href="https://gohugo.io/"  rel="noopener">
                  <i class='fa fa-book'></i> Hugo Documentation
                </a>
            </li>
            <li class="" role="">
                <a href="https://github.com/vjeantet/hugo-theme-docdock"  rel="noopener">
                  <i class='fa fa-bookmark'></i> DocDock Theme
                </a>
            </li>
            <li class="" role="">
                <a href="https://blogs.unimelb.edu.au/pearg/"  rel="noopener">
                  <i class='fa fa-globe'></i> PEARG homepage
                </a>
            </li>
    </nav>
</header>
<article>
  <aside>
    <ul class="menu">
          <li data-nav-id="/pearg_documentation/" class="dd-item">
          <a href="/pearg_documentation/">
            <i class="fa fa-fw fa-home"></i>
          </a>
          </li>
    <li data-nav-id="https://pearg.github.io/pearg_documentation/getting-started/" class="dd-item alwaysopen haschildren
        ">
      <div>
      <a href="/pearg_documentation/getting-started/">Getting Started</a>
            <i class="fa fa-angle-down fa-lg category-icon"></i>
      </div>
        <ul>
      <li data-nav-id="https://pearg.github.io/pearg_documentation/getting-started/hpc-resources/" class="dd-item">
        <div>
          <a href="/pearg_documentation/getting-started/hpc-resources/">
            Compute Resources
          </a>
        </div>
    </li>
      <li data-nav-id="https://pearg.github.io/pearg_documentation/getting-started/getting-an-account/" class="dd-item">
        <div>
          <a href="/pearg_documentation/getting-started/getting-an-account/">
            Getting an Account
          </a>
        </div>
    </li>
      <li data-nav-id="https://pearg.github.io/pearg_documentation/getting-started/getting-help/" class="dd-item">
        <div>
          <a href="/pearg_documentation/getting-started/getting-help/">
            Getting Help
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="https://pearg.github.io/pearg_documentation/best-practices/" class="dd-item alwaysopen haschildren
        ">
      <div>
      <a href="/pearg_documentation/best-practices/">Best Practices</a>
            <i class="fa fa-angle-down fa-lg category-icon"></i>
      </div>
        <ul>
      <li data-nav-id="https://pearg.github.io/pearg_documentation/best-practices/directory-structure/" class="dd-item">
        <div>
          <a href="/pearg_documentation/best-practices/directory-structure/">
            Directory Structure
          </a>
        </div>
    </li>
      <li data-nav-id="https://pearg.github.io/pearg_documentation/best-practices/naming-files/" class="dd-item">
        <div>
          <a href="/pearg_documentation/best-practices/naming-files/">
            Naming Files
          </a>
        </div>
    </li>
      <li data-nav-id="https://pearg.github.io/pearg_documentation/best-practices/backing-up-your-data/" class="dd-item">
        <div>
          <a href="/pearg_documentation/best-practices/backing-up-your-data/">
            Backing Up Your Data
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="https://pearg.github.io/pearg_documentation/metadata-documentation/" class="dd-item alwaysopen haschildren
        ">
      <div>
      <a href="/pearg_documentation/metadata-documentation/">Metadata Documentation</a>
            <i class="fa fa-angle-down fa-lg category-icon"></i>
      </div>
        <ul>
      <li data-nav-id="https://pearg.github.io/pearg_documentation/metadata-documentation/metadata-overview/" class="dd-item">
        <div>
          <a href="/pearg_documentation/metadata-documentation/metadata-overview/">
            Metadata Overview
          </a>
        </div>
    </li>
      <li data-nav-id="https://pearg.github.io/pearg_documentation/metadata-documentation/using-mediaflux/" class="dd-item">
        <div>
          <a href="/pearg_documentation/metadata-documentation/using-mediaflux/">
            Using Mediaflux
          </a>
        </div>
    </li>
      <li data-nav-id="https://pearg.github.io/pearg_documentation/metadata-documentation/mediaflux-explorer/" class="dd-item">
        <div>
          <a href="/pearg_documentation/metadata-documentation/mediaflux-explorer/">
            Mediaflux Explorer
          </a>
        </div>
    </li>
      <li data-nav-id="https://pearg.github.io/pearg_documentation/metadata-documentation/sample-map/" class="dd-item">
        <div>
          <a href="/pearg_documentation/metadata-documentation/sample-map/">
            Sample Map
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="https://pearg.github.io/pearg_documentation/usage-documentation/" class="dd-item alwaysopen haschildren
        ">
      <div>
      <a href="/pearg_documentation/usage-documentation/">Usage Documentation</a>
            <i class="fa fa-angle-down fa-lg category-icon"></i>
      </div>
        <ul>
      <li data-nav-id="https://pearg.github.io/pearg_documentation/usage-documentation/running-jobs-with-slurm/" class="dd-item">
        <div>
          <a href="/pearg_documentation/usage-documentation/running-jobs-with-slurm/">
            Running Jobs with SLURM
          </a>
        </div>
    </li>
      <li data-nav-id="https://pearg.github.io/pearg_documentation/usage-documentation/using-vnc/" class="dd-item">
        <div>
          <a href="/pearg_documentation/usage-documentation/using-vnc/">
            Using VNC
          </a>
        </div>
    </li>
      <li data-nav-id="https://pearg.github.io/pearg_documentation/usage-documentation/installing-software/" class="dd-item">
        <div>
          <a href="/pearg_documentation/usage-documentation/installing-software/">
            Installing Software
          </a>
        </div>
    </li>
      <li data-nav-id="https://pearg.github.io/pearg_documentation/usage-documentation/stacks-databases/" class="dd-item">
        <div>
          <a href="/pearg_documentation/usage-documentation/stacks-databases/">
            Stacks Databases
          </a>
        </div>
    </li>
      <li data-nav-id="https://pearg.github.io/pearg_documentation/usage-documentation/rad-seq-pipeline/" class="dd-item">
        <div>
          <a href="/pearg_documentation/usage-documentation/rad-seq-pipeline/">
            Using the RAD-seq Pipeline
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="https://pearg.github.io/pearg_documentation/tutorials/" class="dd-item alwaysopen haschildren
        ">
      <div>
      <a href="/pearg_documentation/tutorials/">Tutorials</a>
            <i class="fa fa-angle-down fa-lg category-icon"></i>
      </div>
        <ul>
      <li data-nav-id="https://pearg.github.io/pearg_documentation/tutorials/intro-rad-seq/" class="dd-item">
        <div>
          <a href="/pearg_documentation/tutorials/intro-rad-seq/">
            Introduction to RAD-Seq
          </a>
        </div>
    </li>
        </ul>
    </li>




    </ul>
    <section>
    </section>
  </aside>
  <section class="page">
    
    <div class="nav-select">
      <center>Navigation : 
        <select onchange="javascript:location.href = this.value;">
          
    <option value="/pearg_documentation/getting-started/" >
   Getting Started</option> 
      <option value="/pearg_documentation/getting-started/hpc-resources/" >- Compute Resources</option>
      <option value="/pearg_documentation/getting-started/getting-an-account/" >- Getting an Account</option>
      <option value="/pearg_documentation/getting-started/getting-help/" >- Getting Help</option>
  
    <option value="/pearg_documentation/best-practices/" >
   Best Practices</option> 
      <option value="/pearg_documentation/best-practices/directory-structure/" >- Directory Structure</option>
      <option value="/pearg_documentation/best-practices/naming-files/" >- Naming Files</option>
      <option value="/pearg_documentation/best-practices/backing-up-your-data/" >- Backing Up Your Data</option>
  
    <option value="/pearg_documentation/metadata-documentation/" >
   Metadata Documentation</option> 
      <option value="/pearg_documentation/metadata-documentation/metadata-overview/" >- Metadata Overview</option>
      <option value="/pearg_documentation/metadata-documentation/using-mediaflux/" >- Using Mediaflux</option>
      <option value="/pearg_documentation/metadata-documentation/mediaflux-explorer/" >- Mediaflux Explorer</option>
      <option value="/pearg_documentation/metadata-documentation/sample-map/" >- Sample Map</option>
  
    <option value="/pearg_documentation/usage-documentation/" >
   Usage Documentation</option> 
      <option value="/pearg_documentation/usage-documentation/running-jobs-with-slurm/"  selected>- Running Jobs with SLURM</option>
      <option value="/pearg_documentation/usage-documentation/using-vnc/" >- Using VNC</option>
      <option value="/pearg_documentation/usage-documentation/installing-software/" >- Installing Software</option>
      <option value="/pearg_documentation/usage-documentation/stacks-databases/" >- Stacks Databases</option>
      <option value="/pearg_documentation/usage-documentation/rad-seq-pipeline/" >- Using the RAD-seq Pipeline</option>
  
    <option value="/pearg_documentation/tutorials/" >
   Tutorials</option> 
      <option value="/pearg_documentation/tutorials/intro-rad-seq/" >- Introduction to RAD-Seq</option>
  



        </select>
      </center>
    </div>
      <div>
        <div class="searchbox">
          <input data-search-input id="search-by" type="text" placeholder="Search...">
        </div>
      </div>
    

    <h1>Running Jobs with SLURM</h1>
    
    
    
    <p>Using a computer cluster with other users means sharing resources. SLURM
(Simple Linux Utility for Resource Management) is a commonly used job scheduler
that manages a queue where you submit your jobs and allocates
resources to run your job when resources are available.</p>
<p>The documentation on using SLURM for Spartan is quite
comprehensive and can be found
<a href="https://dashboard.hpc.unimelb.edu.au/job_submission/">here</a>.</p>
<h2 id="checking-the-status-of-your-jobs">Checking the status of your jobs</h2>
<h3 id="squeue">squeue</h3>
<p>You can view information about jobs in the SLURM queue with the <code>squeue</code>
command. View the help message with <code>squeue --usage</code> or the manual with
<code>man squeue</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># List all jobs in the queue</span>
squeue

<span style="color:#75715e"># List all jobs for account UOM0041</span>
squeue --account<span style="color:#f92672">=</span>UOM0041

<span style="color:#75715e"># List all jobs in the queue for user jchung in long format</span>
squeue -l -u jchung
</code></pre></div><p>If you&rsquo;re using Spartan, you can also use the <code>showq</code> command.</p>
<h4 id="scontrol-show-job">scontrol show job</h4>
<p>If you want information regarding a specific job id, you can use <code>scontrol</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">scontrol show job &lt;job-id&gt;
</code></pre></div><h4 id="sacct">sacct</h4>
<p>You can check the status of recently finished jobs with <code>sacct</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sacct
</code></pre></div><h4 id="sinfo">sinfo</h4>
<p>You can also view the status of the nodes in the cluster with <code>sinfo</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Show status of all nodes</span>
sinfo -Nel
</code></pre></div><p>If you want more information about a specific node, you can use <code>scontrol</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># View information on the master node</span>
scontrol show node master
</code></pre></div><h2 id="running-your-jobs">Running your jobs</h2>
<h3 id="sbatch">sbatch</h3>
<p>Most of your jobs will be sumbitted to SLURM via <code>sbatch</code>. The commands that
you want to run need to be written in a script (a plain-text file that we&rsquo;ll
discuss further below), saved to a location, then submitted using <code>sbatch</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Print the help message from sbatch</span>
sbatch --help

<span style="color:#75715e"># Submit your script by specifying the name of your script</span>
sbatch my-script.sh
</code></pre></div><h3 id="sinteractive">sinteractive</h3>
<p>You can use the <code>sinteractive</code> command to run your job in an interactive
session. When SLURM allocates your job resources, you will be provided with
an interactive terminal session. It is recommended to use sinteractive in
conjunction with a terminal multiplexer such as GUN Screen so the job won&rsquo;t
terminate if you disconnect from the server.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Print the help message for sinteractive</span>
sinteractive --help

<span style="color:#75715e"># Submit a job with the default parameters</span>
sinteractive

<span style="color:#75715e"># Submit a job with 4 CPUs, 16 GB memory, and wall time of 1 day</span>
sinteractive --ntasks<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> --cpu-per-task<span style="color:#f92672">=</span><span style="color:#ae81ff">4</span> --mem<span style="color:#f92672">=</span><span style="color:#ae81ff">16384</span> --time<span style="color:#f92672">=</span>1-0:0:0
</code></pre></div><p>Note that the memory amount is specified in MB.</p>
<h3 id="scancel">scancel</h3>
<p>You can cancel a running job or a job in the queue with <code>scancel</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">scancel &lt;job-id&gt;
</code></pre></div><h2 id="writing-a-slurm-script">Writing a SLURM script</h2>
<p>For beginners, I recommend using a
<a href="https://dashboard.hpc.unimelb.edu.au/forms/script_generator/">job script generator</a>.
If you&rsquo;re using one of the PEARG clusters on the Nectar cloud (i.e. mozzie or
rescue), you can ignore the &ldquo;Project ID&rdquo; and the &ldquo;Modules&rdquo; field.</p>
<p>Here&rsquo;s an example of a simple SLURM script running on the mozzie server.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">#!/bin/bash
#SBATCH --job-name=denovo_map
#SBATCH --nodes=1
#SBATCH --ntasks=1
#SBATCH --cpus-per-task=8

denovo_map.pl \
    -m 3 -M 2 -n 1 -T 8 -b 1 -S \
    -o denovo_map_m3_M2_n1_2017-11-09 \
    -s ../processed_radtags/sample-1.fastq.gz \
    -s ../processed_radtags/sample-2.fastq.gz \
    -X &#34;populations: --vcf&#34;
</code></pre></div><p>The first line of the script must specify the interpreter the script will be
executed with such as <code>bash</code> or <code>sh</code>. Keep this as <code>#!/bin/bash</code> unless you
have reason to change it.</p>
<p>Each line starting with <code>#SBATCH</code> is an option that SLURM&rsquo;s <code>sbatch</code> command
uses. You can get view all available options with <code>sbatch -h</code> or by viewing
the man page with <code>man sbatch</code>.</p>
<p>The most common <code>#SBATCH</code> options you&rsquo;ll most likely be using are:</p>
<ul>
<li><code>--job-name=XXX</code>: You should always specify a job name for your job</li>
<li><code>--nodes=1</code>: In most cases, you should be requesting one node so all the
requested CPUs are on the same node.</li>
<li><code>--ntasks=1</code>: In most cases you&rsquo;ll be running one task per job</li>
<li><code>--cpus-per-task=X</code>: Specify the number of CPUs to request.</li>
</ul>
<p>You can also direct your stdout and stderr into defined files:</p>
<ul>
<li><code>--output=my-file-%j.out</code></li>
<li><code>--error=my-file-%j.err</code></li>
</ul>
<p>If you&rsquo;re using Spartan, you&rsquo;ll also need to specify memory in MB with:</p>
<ul>
<li><code>--mem=XXXXX</code> for jobs using multiple CPUs, or</li>
<li><code>--mem-per-cpu=XXXX</code> for single CPU jobs.</li>
</ul>
<p>With Spartan, you&rsquo;ll also need to specify the partition, and a time limit:</p>
<ul>
<li><code>-p main</code>: The partition is called &lsquo;main&rsquo;</li>
<li><code>--time=D-HH:MM:SS</code>: Time limit given for the job. If the job exceeds the time,
it is automatically terminated.</li>
</ul>
<p>Here&rsquo;s an example of a SLURM script for Spartan&rsquo;s physical partition.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">#!/bin/bash

# Partition for the job:
#SBATCH -p physical

# Account to run the job:
#SBATCH --account=punim0395

# Multithreaded (SMP) job: must run on one node
#SBATCH --nodes=1

# The name of the job:
#SBATCH --job-name=&#34;test-job&#34;

# Maximum number of tasks/CPU cores used by the job:
#SBATCH --ntasks=1
#SBATCH --cpus-per-task=8

# The amount of memory in megabytes per process in the job:
#SBATCH --mem=32768

# The maximum running time of the job in days-hours:mins:sec
#SBATCH --time=0-1:0:00

# Run the job from your home directory:
cd $HOME

# The job command(s):
sleep 10
</code></pre></div><p>When using Spartan, don&rsquo;t forget to <code>module load</code> the software you
need into your environment path.</p>


    
    
        <div class="chevrons">
    <div id="navigation">
<a class="nav nav-prev" href="/pearg_documentation/usage-documentation/" title="Usage Documentation"> <i class="fa fa-chevron-left"></i><label>Usage Documentation</label></a>
    <a class="nav nav-next" href="/pearg_documentation/usage-documentation/using-vnc/" title="Using VNC" style="margin-right: 0px;"><label>Using VNC</label><i class="fa fa-chevron-right"></i></a></div>
  </div>

  </section>
</article>

<footer>

<div class="footline">
    

    

    
    <div class="date">
        <i class='fa fa-calendar'></i> Last update on 11/08/2017
    </div>
    

    
    <div class="github-link">
      <a href="https://github.com/pearg/pearg_documentation/edit/master/content/usage-documentation/running-jobs-with-slurm.md" target="blank"><i class="fa fa-code-fork"></i>
        Improve this page</a>
    </div>
    
  </div>


	<div>


  
    Create a content/_footer.md file to customize the footer content
  



	</div>
</footer>

<script src="/pearg_documentation/js/jquery-2.x.min.js"></script>
<script type="text/javascript">
    
        var baseurl = "https:\/\/pearg.github.io\/pearg_documentation\/";
    
</script>
<script src="/pearg_documentation/js/clipboard.min.js"></script>
<script src="/pearg_documentation/js/featherlight.min.js"></script>

<script type="text/javascript" src="/pearg_documentation/js/lunr.min.js"></script>
<script type="text/javascript" src="/pearg_documentation/js/auto-complete.js"></script>
<script type="text/javascript" src="/pearg_documentation/js/search.js"></script>
<script src="/pearg_documentation/theme-flex/script.js"></script>




<script src="https://pearg.github.io/pearg_documentation/js/scripts.min.js"></script>
    

    
    

    
  </body>
</html>